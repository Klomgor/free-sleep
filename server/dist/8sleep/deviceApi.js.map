{"version":3,"file":"deviceApi.js","sources":["8sleep/deviceApi.ts"],"sourceRoot":"/","sourcesContent":["import _ from 'lodash';\nimport { getFranken } from './frankenServer.js';\nimport logger from '../logger.js';\n\n\nexport const frankenCommands = {\n  HELLO: '0',\n  SET_TEMP: '1',\n  SET_ALARM: '2',\n  // RESET: '3',\n  // FORCE_RESET: '4',\n  ALARM_LEFT: '5',\n  ALARM_RIGHT: '6',\n  // FORMAT: '7',\n  SET_SETTINGS: '8',\n  LEFT_TEMP_DURATION: '9',\n  RIGHT_TEMP_DURATION: '10',\n  TEMP_LEVEL_LEFT: '11',\n  TEMP_LEVEL_RIGHT: '12',\n  PRIME: '13',\n  DEVICE_STATUS: '14',\n  ALARM_CLEAR: '16',\n  // ALARM_SOLO: \"17\",\n  // STOP_PRIME: \"18\",\n} as const;\n\n\nexport const invertedFrankenCommands = _.invert(frankenCommands);\n// eslint-disable-next-line @typescript-eslint/no-type-alias\nexport type FrankenCommand = keyof typeof frankenCommands;\n\n\nexport async function executeFunction(command: FrankenCommand, arg = 'empty'): Promise<void> {\n  logger.debug(`Executing command | command: ${command} | arg: ${arg}`);\n\n  const franken = await getFranken();\n  // const frankenCommand = funcNameToFrankenCommand[name];\n  // if franken disconnects right before a function call this will throw\n  // the error will bubble up to the main loop of the device-api-client (protocol handling)\n  // and the client will crash disconnecting from device-api - this is safe, it's correctly cleaned-up,\n  // deviceApiLoop will take care of reconnecting to device-api\n  const response = await franken.callFunction(command, arg);\n  logger.debug(response);\n\n  return response;\n}\n"],"names":[],"mappings":";;AAAA,OAAO,CAAC,MAAM,QAAQ,CAAC;AACvB,OAAO,EAAE,UAAU,EAAE,MAAM,oBAAoB,CAAC;AAChD,OAAO,MAAM,MAAM,cAAc,CAAC;AAGlC,MAAM,CAAC,MAAM,eAAe,GAAG;IAC7B,KAAK,EAAE,GAAG;IACV,QAAQ,EAAE,GAAG;IACb,SAAS,EAAE,GAAG;IACd,cAAc;IACd,oBAAoB;IACpB,UAAU,EAAE,GAAG;IACf,WAAW,EAAE,GAAG;IAChB,eAAe;IACf,YAAY,EAAE,GAAG;IACjB,kBAAkB,EAAE,GAAG;IACvB,mBAAmB,EAAE,IAAI;IACzB,eAAe,EAAE,IAAI;IACrB,gBAAgB,EAAE,IAAI;IACtB,KAAK,EAAE,IAAI;IACX,aAAa,EAAE,IAAI;IACnB,WAAW,EAAE,IAAI;IACjB,oBAAoB;IACpB,oBAAoB;CACZ,CAAC;AAGX,MAAM,CAAC,MAAM,uBAAuB,GAAG,CAAC,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;AAKjE,MAAM,CAAC,KAAK,UAAU,eAAe,CAAC,OAAuB,EAAE,GAAG,GAAG,OAAO;IAC1E,MAAM,CAAC,KAAK,CAAC,gCAAgC,OAAO,WAAW,GAAG,EAAE,CAAC,CAAC;IAEtE,MAAM,OAAO,GAAG,MAAM,UAAU,EAAE,CAAC;IACnC,yDAAyD;IACzD,sEAAsE;IACtE,yFAAyF;IACzF,qGAAqG;IACrG,6DAA6D;IAC7D,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,YAAY,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;IAC1D,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IAEvB,OAAO,QAAQ,CAAC;AAClB,CAAC","debug_id":"7c7e2b23-d1ea-59bd-a0e6-80f40a326baa"}