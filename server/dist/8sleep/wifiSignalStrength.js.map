{"version":3,"file":"wifiSignalStrength.js","sources":["8sleep/wifiSignalStrength.ts"],"sourceRoot":"/","sourcesContent":["import { exec } from 'child_process';\nimport logger from '../logger.js';\n\nfunction execAsync(cmd: string) {\n  return new Promise((resolve) => {\n    exec(cmd, { timeout: 2000 }, (error, stdout, stderr) => {\n      if (error) {\n        return resolve({ ok: false, error: error.message.trim() });\n      }\n      if (stderr) {\n        return resolve({ ok: false, error: stderr.trim() });\n      }\n      resolve({ ok: true, stdout: stdout.trim() });\n    });\n  });\n}\n\nexport let WIFI_SIGNAL_STRENGTH = 0;\n\nexport async function loadWifiSignalStrength() {\n  try {\n    const result = await execAsync(`nmcli -t -f ACTIVE,SSID,SIGNAL dev wifi`);\n\n    // @ts-expect-error\n    if (!result.ok) {\n      return 0;\n    }\n\n    // @ts-expect-error\n    const activeLine = result.stdout\n      .split('\\n')\n      .find((line: string) => line.startsWith('yes:'));\n\n    if (!activeLine) {\n      return 0;\n    }\n\n    const parts = activeLine.split(':');\n    const signal = Number(parts[2]) || 0;\n\n    WIFI_SIGNAL_STRENGTH = signal;\n    return WIFI_SIGNAL_STRENGTH;\n  } catch (error) {\n    logger.error(error);\n  }\n}\n"],"names":[],"mappings":";;AAAA,OAAO,EAAE,IAAI,EAAE,MAAM,eAAe,CAAC;AACrC,OAAO,MAAM,MAAM,cAAc,CAAC;AAElC,SAAS,SAAS,CAAC,GAAW;IAC5B,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,EAAE;QAC7B,IAAI,CAAC,GAAG,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,EAAE;YACrD,IAAI,KAAK,EAAE,CAAC;gBACV,OAAO,OAAO,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;YAC7D,CAAC;YACD,IAAI,MAAM,EAAE,CAAC;gBACX,OAAO,OAAO,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;YACtD,CAAC;YACD,OAAO,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;QAC/C,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC;AAED,MAAM,CAAC,IAAI,oBAAoB,GAAG,CAAC,CAAC;AAEpC,MAAM,CAAC,KAAK,UAAU,sBAAsB;IAC1C,IAAI,CAAC;QACH,MAAM,MAAM,GAAG,MAAM,SAAS,CAAC,yCAAyC,CAAC,CAAC;QAE1E,mBAAmB;QACnB,IAAI,CAAC,MAAM,CAAC,EAAE,EAAE,CAAC;YACf,OAAO,CAAC,CAAC;QACX,CAAC;QAED,mBAAmB;QACnB,MAAM,UAAU,GAAG,MAAM,CAAC,MAAM;aAC7B,KAAK,CAAC,IAAI,CAAC;aACX,IAAI,CAAC,CAAC,IAAY,EAAE,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;QAEnD,IAAI,CAAC,UAAU,EAAE,CAAC;YAChB,OAAO,CAAC,CAAC;QACX,CAAC;QAED,MAAM,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACpC,MAAM,MAAM,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;QAErC,oBAAoB,GAAG,MAAM,CAAC;QAC9B,OAAO,oBAAoB,CAAC;IAC9B,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;IACtB,CAAC;AACH,CAAC","debug_id":"e7951faa-771c-5de4-bed5-937e3379a3a4"}